# -*- coding: utf-8 -*-
"""Data-Cleaning-With-Goolge-Playstore-Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1fWwTfhPtnnKQvdtcmJpkeofWsj2DkOh4
"""

# Commented out IPython magic to ensure Python compatibility.
#Importing necessary things ... !
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')
# %matplotlib inline

df = pd.read_csv('https://raw.githubusercontent.com/krishnaik06/playstore-Dataset/main/googleplaystore.csv')

df.head() #see the first few rows

df.shape #number of rows and columns

df.info()

# Summary
df.describe()

#Checking for missing values
df.isnull()

#Number of missing values in each column
df.isnull().sum()

#Clearly, the dataset has missing values
#Basically, we are starting the data cleaning

#Let's first see the top 2 rows
df.head(2)

df['Reviews'].unique()  # Check unique entries; confirms the 'Reviews' column contains string values, not numeric
#Clearly, string values are there

df['Reviews'].str.isnumeric().sum()  # Count how many entries in 'Reviews' consist only of numeric characters
#Clearly, out of 10841; 10840 are in numeric form (but written in string), while 1 is not like so.

df[~df['Reviews'].str.isnumeric()]  # Filter rows where 'Reviews' contains non-numeric values

#Dropping this unwanted row
df_copy = df.copy() #create a copy of the original

# now dropping with index number
df_copy = df_copy.drop(df_copy.index[10472])

#Rechecking if we managed to drop it or not
df_copy[~df_copy['Reviews'].str.isnumeric()]
#Clearly, no such row now exists

#Converting the review datatype to int
df_copy['Reviews'] = df_copy['Reviews'].astype('int')

df_copy.info() #checking if we managed to change it to int type or not

#now we will target the size column

df_copy['Size'].unique()  # Inspect unique values to understand the formats used in the 'Size' column

#Checking if null values are there in the Size col
df_copy['Size'].isnull().sum()

#we now need to remove the M and k from the size column

df_copy['Size'] = df_copy['Size'].replace('M','000') #converting into k units
df_copy['Size'] = df_copy['Size'].replace('k','')
df_copy['Size'] = df_copy['Size'].replace('Varies with device',np.nan)

df_copy.info()

#df_copy with respect to size
df_copy['Size']
#Clearly, there is NaN value in this Size column

#Now, we shall work to replace that row or drop that row

df_copy['Installs'].unique() #Clearly, different kind of values are there

df_copy['Price'].unique() #Clearly, different kinds of values can be seen

chars_to_remove = ['+', ',', '$']  # Characters to strip from numeric-like text fields
cols_to_clean = ['Installs', 'Price']  # Columns that require character cleanup before type conversion

for item in chars_to_remove:
    for cols in cols_to_clean:
        df_copy[cols] = df_copy[cols].str.replace(item, '')  # Remove unwanted characters from selected columns

df_copy['Price'].unique()

#Converting to the integer type
df_copy['Installs'] = df_copy['Installs'].astype('int')
df_copy['Price'] = df_copy['Price'].astype('float')

df_copy.info()

# Now we will target the last updated column
df_copy['Last Updated'].unique()

df_copy['Last Updated']= pd.to_datetime(df_copy['Last Updated'])

df_copy['Day'] = df_copy['Last Updated'].dt.day  #Creating new column for them
df_copy['Month'] = df_copy['Last Updated'].dt.month #Creating new column for them
df_copy['Year'] = df_copy['Last Updated'].dt.year #Creating new column for them

df_copy.info()

df_copy.head()

#saving the dataset
df_copy = df_copy.to_csv('cleaned_data.csv')